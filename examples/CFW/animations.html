<!DOCTYPE html>
<html>
<head>
    <title>canvas fw test: Animate with timer</title>

    <script src="../../bower_components/ImageLoader/build/ImageLoader.min.js"></script>
    <script src="../../build/canvasfw.js"></script>

</head>

<body style="background-color: #AAAAAA;">

    <script>
        (function(){

            var layer = new Layer();
            layer.enableFullScreen();
            layer.enableOnRollEvents();
            document.body.appendChild(layer.getCanvas());

            var loader = new ImageLoader({
                images:['../assets/sample1_tb.png', '../assets/sample2_tb.png'],
                onComplete: onComplete,
            });

            function onComplete()
            {
                var canvasutil = new CanvasUtil();
                var imageData1 = canvasutil.getImageDataFromTag(loader.getItemAt(0).tag);
                var imageData2 = canvasutil.getImageDataFromTag(loader.getItemAt(1).tag);
                var graphic1 = new Graphic({imageData: imageData1, x: 10, y: 10});
                var graphic2 = new Graphic({imageData: imageData2, x: 10, y: 100});

                layer.addGraphic(graphic1);
                layer.addGraphic(graphic2);

                var timer = new Timer({
                    renderCallback: renderHandler,
                    updateCallback: updateHandler,
                    frameRate: 30
                });

                timer.start();

                var fadeInOptions = {
                    property: "x",
                    duration: 500,
                    from: 10,
                    to: 30
                };

                var fadeOutOptions = {
                    property: "x",
                    duration: 500,
                    from: 30,
                    to: 10
                }

                graphic1.onRollOver = rollOverHandler;
                graphic1.onRollOut = rollOutHandler;
                graphic2.onRollOver = rollOverHandler;
                graphic2.onRollOut = rollOutHandler;

                function renderHandler()
                {
                    layer.render();
                }

                function updateHandler()
                {
                    layer.update();
                    Animator.update();
                }

                function rollOverHandler()
                {
                    Animator.play(this, fadeInOptions);
                }

                function rollOutHandler()
                {
                    Animator.play(this, fadeOutOptions);
                }
            }
        })();


    </script>
</body>
</html>